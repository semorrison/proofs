(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     42867,       1067]
NotebookOptionsPosition[     41124,       1011]
NotebookOutlinePosition[     41481,       1027]
CellTagsIndexPosition[     41438,       1024]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", "re"}], "-", 
     RowBox[{"implementation", " ", "of", " ", 
      RowBox[{"http", ":"}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"arxiv", ".", "org"}], "/", "abs"}], "/", "1309.4501"}]}], ",", 
   " ", 
   RowBox[{"in", " ", 
    RowBox[{"progress", "!"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.595901441214106*^9, 3.59590145027022*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"definition", "[", 
   RowBox[{"isOpen", "[", "X_", "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"forAll", "[", 
   RowBox[{"x", ",", 
    RowBox[{"implies", "[", 
     RowBox[{
      RowBox[{"x", "\[Element]", "X"}], ",", 
      RowBox[{"exists", "[", 
       RowBox[{"\[Delta]", ",", 
        RowBox[{"forAll", "[", 
         RowBox[{"y", ",", 
          RowBox[{"implies", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "<", "\[Delta]"}], ",", 
            RowBox[{"y", "\[Element]", "X"}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5958141560533323`*^9, 3.5958142162527227`*^9}, {
  3.5958153399502563`*^9, 3.5958153441636467`*^9}, {3.5958933798215322`*^9, 
  3.595893387735279*^9}, {3.595893615756228*^9, 3.595893616032484*^9}, {
  3.595920697807735*^9, 3.595920712081505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandsToUniversalQuantifier", "[", "expression_", "]"}], ":=", 
  RowBox[{"MatchQ", "[", 
   RowBox[{
    RowBox[{"definition", "[", "expression", "]"}], ",", 
    RowBox[{"forAll", "[", 
     RowBox[{"_", ",", "_"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.595893287359755*^9, 3.595893291438507*^9}, {
  3.595893351749137*^9, 3.595893360021954*^9}, {3.595893391989118*^9, 
  3.595893407419901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandsToExistentialQuantifier", "[", "expression_", "]"}], ":=", 
  RowBox[{"MatchQ", "[", 
   RowBox[{
    RowBox[{"definition", "[", "expression", "]"}], ",", 
    RowBox[{"exists", "[", 
     RowBox[{"_", ",", "_"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.595893287359755*^9, 3.595893291438507*^9}, {
  3.595893351749137*^9, 3.595893360021954*^9}, {3.595893391989118*^9, 
  3.595893423697756*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hypothesisCounter", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextHypothesisNumber", ":=", 
   RowBox[{"hypothesisCounter", "++"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", "]"}], ":=", 
  RowBox[{"H", "[", "nextHypothesisNumber", "]"}]}]}], "Input",
 CellChangeTimes->{{3.5958146092662687`*^9, 3.5958146529532413`*^9}, {
  3.5958157360162*^9, 3.595815754204816*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"targetCounter", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextTargetNumber", ":=", 
   RowBox[{"targetCounter", "++"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "[", "]"}], ":=", 
  RowBox[{"T", "[", "nextTargetNumber", "]"}]}]}], "Input",
 CellChangeTimes->{{3.5958146092662687`*^9, 3.5958146529532413`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"ProofStep", ",", "Prove"}], "]"}]], "Input",
 CellChangeTimes->{{3.595816056247487*^9, 3.5958160576182137`*^9}, 
   3.595816615810998*^9, {3.595817010324218*^9, 3.595817010911459*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProofStep", "[", 
   RowBox[{"goal", ":", 
    RowBox[{"ProofGoal", "[", 
     RowBox[{"hypotheses_List", ",", 
      RowBox[{"{", 
       RowBox[{"Ta___", ",", 
        RowBox[{
         RowBox[{"T", "[", "i_", "]"}], "\[Rule]", 
         RowBox[{"expression_", "?", "expandsToUniversalQuantifier"}]}], ",", 
        "Tb___"}], "}"}]}], "]"}]}], "]"}], ":=", 
  RowBox[{"ProofStep", "[", 
   RowBox[{"goal", ",", 
    RowBox[{"\"\<Expand pre-universal target T\>\"", "<>", 
     RowBox[{"ToString", "[", "i", "]"}]}], ",", "\"\<\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ProofGoal", "[", 
     RowBox[{"hypotheses", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Ta", ",", "Tb", ",", 
        RowBox[{
         RowBox[{"T", "[", "]"}], "\[Rule]", 
         RowBox[{"definition", "[", "expression", "]"}]}]}], "}"}]}], "]"}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.595814498484351*^9, 3.59581457315106*^9}, {
  3.595814657594615*^9, 3.595814659247044*^9}, {3.595814862455468*^9, 
  3.595814870436385*^9}, {3.59581544034166*^9, 3.595815480427747*^9}, {
  3.5958166101552067`*^9, 3.595816612016342*^9}, {3.59581698299196*^9, 
  3.595816985041644*^9}, {3.595817287069539*^9, 3.595817292230298*^9}, {
  3.5958934582433357`*^9, 3.595893467551723*^9}, {3.59589360224851*^9, 
  3.5958936060520973`*^9}, {3.595893759657474*^9, 3.5958937625848217`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProofStep", "[", 
   RowBox[{"goal", ":", 
    RowBox[{"ProofGoal", "[", 
     RowBox[{"hypotheses_List", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Ta___", ",", 
        RowBox[{
         RowBox[{"T", "[", "i_", "]"}], "\[Rule]", 
         RowBox[{"forAll", "[", 
          RowBox[{"x_", ",", 
           RowBox[{"implies", "[", 
            RowBox[{"P_", ",", "Q_"}], "]"}]}], "]"}]}], ",", "Tb___"}], 
       "}"}]}], "]"}]}], "]"}], ":=", 
  RowBox[{"ProofStep", "[", 
   RowBox[{"goal", ",", 
    RowBox[{
    "\"\<Apply the `let' trick and move premise of universal-condition target \
T\>\"", "<>", 
     RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\< above the line.\>\""}], 
    ",", 
    RowBox[{"textString", "[", 
     RowBox[{"\"\<Let \>\"", ",", 
      RowBox[{"tex", "[", "P", "]"}], ",", "\"\<.\>\""}], "]"}], ",", 
    RowBox[{"ProofGoal", "[", 
     RowBox[{
      RowBox[{"hypotheses", "~", "Join", "~", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"H", "[", "]"}], "\[Rule]", "P"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"T", "[", "]"}], "\[Rule]", "Q"}], ",", "Ta", ",", "Tb"}], 
       "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.595814718700018*^9, 3.595814923914349*^9}, {
   3.5958153804341383`*^9, 3.595815380513587*^9}, {3.595815453788468*^9, 
   3.595815486164075*^9}, {3.595815523082206*^9, 3.595815531411374*^9}, 
   3.5958166188788977`*^9, {3.595816913842226*^9, 3.5958169161841307`*^9}, {
   3.595816974137295*^9, 3.595816989843709*^9}, {3.595817295302731*^9, 
   3.595817298798168*^9}, {3.595893942126905*^9, 3.595893948410844*^9}, {
   3.595894972286098*^9, 3.5958949734735317`*^9}, {3.595920148686054*^9, 
   3.595920149031646*^9}, {3.595920829002565*^9, 3.595920832090849*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProofStep", "[", 
   RowBox[{"goal", ":", 
    RowBox[{"ProofGoal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ha___", ",", 
        RowBox[{
         RowBox[{"H", "[", "i_", "]"}], "\[Rule]", 
         RowBox[{"x_", "\[Element]", 
          RowBox[{"intersect", "[", 
           RowBox[{"A_", ",", "B_"}], "]"}]}]}], ",", "Hb___"}], "}"}], ",", 
      "targets_"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ProofStep", "[", 
   RowBox[{"goal", ",", 
    RowBox[{"\"\<Quantifier-free expansion of hypothesis H\>\"", "<>", 
     RowBox[{"ToString", "[", "i", "]"}]}], ",", 
    RowBox[{"textString", "[", 
     RowBox[{"\"\<Since \>\"", ",", 
      RowBox[{"tex", "[", 
       RowBox[{"x", "\[Element]", 
        RowBox[{"intersect", "[", 
         RowBox[{"A", ",", "B"}], "]"}]}], "]"}], ",", "\"\<, \>\"", ",", 
      RowBox[{"tex", "[", 
       RowBox[{"x", "\[Element]", "A"}], "]"}], ",", "\"\< and \>\"", ",", 
      RowBox[{"tex", "[", 
       RowBox[{"x", "\[Element]", "B"}], "]"}], ",", "\"\<.\>\""}], "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"ProofGoal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ha", ",", 
        RowBox[{
         RowBox[{"H", "[", "]"}], "\[Rule]", 
         RowBox[{"x", "\[Element]", "A"}]}], ",", 
        RowBox[{
         RowBox[{"H", "[", "]"}], "\[Rule]", 
         RowBox[{"x", "\[Element]", "B"}]}], ",", "Hb"}], "}"}], ",", 
      "targets"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.595816257444078*^9, 3.59581637895026*^9}, {
  3.59581649059472*^9, 3.595816556248074*^9}, {3.5958166200042353`*^9, 
  3.595816665021069*^9}, {3.595817303789612*^9, 3.595817308353537*^9}, {
  3.595893905822216*^9, 3.595893935464375*^9}, {3.595893997345064*^9, 
  3.595893997756136*^9}, {3.595920152844492*^9, 3.5959201566003532`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProofStep", "[", "goal_ProofGoal", "]"}], ":=", 
  "$Failed"}]], "Input",
 CellChangeTimes->{{3.595817744519877*^9, 3.5958177763988523`*^9}, {
  3.595817842252821*^9, 3.595817843617365*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Prove", "[", "goal_ProofGoal", "]"}], ":=", 
  RowBox[{"Prove", "[", 
   RowBox[{"PartialProof", "[", 
    RowBox[{"ProofStep", "[", "goal", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Prove", "[", 
   RowBox[{"proof", ":", 
    RowBox[{"PartialProof", "[", 
     RowBox[{"___", ",", "$Failed"}], "]"}]}], "]"}], ":=", "proof"}], "\n", 
 RowBox[{
  RowBox[{"Prove", "[", "proof_PartialProof", "]"}], ":=", 
  RowBox[{"Prove", "[", 
   RowBox[{"Append", "[", 
    RowBox[{"proof", ",", 
     RowBox[{"ProofStep", "[", 
      RowBox[{"proof", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5958166699778223`*^9, 3.59581672530406*^9}, {
   3.595816757288637*^9, 3.595816820979979*^9}, {3.5958173132717533`*^9, 
   3.595817398976836*^9}, {3.5958174778419113`*^9, 3.595817502874645*^9}, {
   3.595817539050746*^9, 3.595817541438314*^9}, 3.595817580121958*^9, {
   3.595817729791098*^9, 3.5958177311289053`*^9}, {3.59581782373263*^9, 
   3.5958178530268087`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tex", "[", 
   RowBox[{"x_", "\[Element]", "Z_"}], "]"}], ":=", 
  RowBox[{"mathString", "[", 
   RowBox[{
    RowBox[{"tex", "[", "x", "]"}], ",", "\"\< \\\\in \>\"", ",", 
    RowBox[{"tex", "[", "Z", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", 
   RowBox[{"a_", "<", "b_"}], "]"}], ":=", 
  RowBox[{"mathString", "[", 
   RowBox[{
    RowBox[{"tex", "[", "a", "]"}], ",", "\"\< < \>\"", ",", " ", 
    RowBox[{"tex", "[", "b", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", "x_Symbol", "]"}], ":=", 
  RowBox[{"mathString", "[", 
   RowBox[{"ToString", "[", 
    RowBox[{"x", ",", "TeXForm"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", 
   RowBox[{"d", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"mathString", "[", 
   RowBox[{"\"\<d(\>\"", ",", 
    RowBox[{"tex", "[", "x", "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"tex", "[", "y", "]"}], ",", "\"\<)\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", 
   RowBox[{"intersect", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], "]"}], ":=", 
  RowBox[{"mathString", "[", 
   RowBox[{
    RowBox[{"tex", "[", "A", "]"}], ",", "\"\< \\\\cap \>\"", ",", 
    RowBox[{"tex", "[", "B", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", 
   RowBox[{"isOpen", "[", "A_", "]"}], "]"}], ":=", 
  RowBox[{"textString", "[", 
   RowBox[{
    RowBox[{"tex", "[", "A", "]"}], ",", "\"\< is open\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", "A___", "]"}], ":=", 
  RowBox[{"textString", "@@", 
   RowBox[{"(", 
    RowBox[{"tex", "/@", 
     RowBox[{"{", "A", "}"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", "s_String", "]"}], ":=", 
  RowBox[{"textString", "[", "s", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", "s_textString", "]"}], ":=", 
  "s"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", "s_mathString", "]"}], ":=", 
  "s"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", 
   RowBox[{"forAll", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"mathString", "[", 
   RowBox[{"\"\<\\\\forall \>\"", ",", 
    RowBox[{"tex", "[", "x", "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"tex", "[", "y", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", 
   RowBox[{"exists", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"mathString", "[", 
   RowBox[{"\"\<\\\\exists \>\"", ",", 
    RowBox[{"tex", "[", "x", "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"tex", "[", "y", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", 
   RowBox[{"implies", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"mathString", "[", 
   RowBox[{
    RowBox[{"tex", "[", "x", "]"}], ",", "\"\< \\\\implies \>\"", ",", 
    RowBox[{"tex", "[", "y", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5958155353874187`*^9, 3.595815692515217*^9}, {
   3.5958158776638002`*^9, 3.595815879292645*^9}, {3.595816439677205*^9, 
   3.595816478564774*^9}, 3.595816829206883*^9, {3.595893673763142*^9, 
   3.5958937306424417`*^9}, {3.5958937907748537`*^9, 3.595893836883164*^9}, 
   3.5958939618564796`*^9, 3.5958941588002253`*^9, {3.595895868859486*^9, 
   3.595895886279448*^9}, {3.595896023928837*^9, 3.5958960450777884`*^9}, {
   3.5959195038530407`*^9, 3.5959196195783*^9}, {3.595920617695365*^9, 
   3.595920673797472*^9}, {3.595920716616444*^9, 3.595920756649108*^9}, {
   3.595920862197465*^9, 3.595920896271779*^9}, {3.595920927728409*^9, 
   3.59592095218966*^9}, {3.595921220151019*^9, 3.595921225894792*^9}}],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"mathString", ",", "Flat"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"textString", ",", "Flat"}], "]"}]}], "Input",
 CellChangeTimes->{{3.595893865603497*^9, 3.595893870966874*^9}, {
  3.5958960669588003`*^9, 3.5958960705003567`*^9}}],

Cell[BoxData[{
 RowBox[{"textString", "/:", 
  RowBox[{"ToString", "[", "T_textString", "]"}], ":=", 
  RowBox[{"StringJoin", "@@", 
   RowBox[{"(", 
    RowBox[{"ToString", "/@", 
     RowBox[{"(", 
      RowBox[{"List", "@@", "T"}], ")"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"mathString", "/:", 
  RowBox[{"ToString", "[", "T_mathString", "]"}], ":=", 
  RowBox[{"\"\<$\>\"", "<>", 
   RowBox[{"(", 
    RowBox[{"StringJoin", "@@", 
     RowBox[{"(", 
      RowBox[{"ToString", "/@", 
       RowBox[{"(", 
        RowBox[{"List", "@@", "T"}], ")"}]}], ")"}]}], ")"}], "<>", 
   "\"\<$\>\""}]}]}], "Input",
 CellChangeTimes->{{3.595894042864317*^9, 3.595894078597513*^9}, {
  3.5958941161977787`*^9, 3.595894148868608*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"proof", "=", 
  RowBox[{"Prove", "[", 
   RowBox[{"ProofGoal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"H", "[", "]"}], "\[Rule]", 
        RowBox[{"isOpen", "[", "A", "]"}]}], ",", 
       RowBox[{
        RowBox[{"H", "[", "]"}], "\[Rule]", 
        RowBox[{"isOpen", "[", "B", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T", "[", "]"}], "\[Rule]", 
       RowBox[{"isOpen", "[", 
        RowBox[{"intersect", "[", 
         RowBox[{"A", ",", "B"}], "]"}], "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.595813458937801*^9, 3.595813543148622*^9}, {
   3.595813899468594*^9, 3.595813905003512*^9}, {3.595813990581974*^9, 
   3.595814009835091*^9}, {3.59581429367336*^9, 3.5958142940137243`*^9}, {
   3.595814579288575*^9, 3.595814579703355*^9}, 3.5958146825703297`*^9, {
   3.595814940233708*^9, 3.5958149435275173`*^9}, {3.595815363941575*^9, 
   3.595815396657464*^9}, {3.595815490348063*^9, 3.595815492729594*^9}, {
   3.595815716553133*^9, 3.595815729427124*^9}, {3.595815864767871*^9, 
   3.595815866034567*^9}, {3.595893746588787*^9, 3.595893751066841*^9}}],

Cell[BoxData[
 RowBox[{"PartialProof", "[", 
  RowBox[{
   RowBox[{"ProofStep", "[", 
    RowBox[{
     RowBox[{"ProofGoal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", "27", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "A", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "28", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "B", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "[", "17", "]"}], "\[Rule]", 
         RowBox[{"isOpen", "[", 
          RowBox[{"intersect", "[", 
           RowBox[{"A", ",", "B"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", "\<\"Expand pre-universal target T17\"\>", ",", "\<\"\"\>", ",", 
     RowBox[{"ProofGoal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", "27", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "A", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "28", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "B", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "[", "18", "]"}], "\[Rule]", 
         RowBox[{"forAll", "[", 
          RowBox[{"x", ",", 
           RowBox[{"implies", "[", 
            RowBox[{
             RowBox[{"x", "\[Element]", 
              RowBox[{"intersect", "[", 
               RowBox[{"A", ",", "B"}], "]"}]}], ",", 
             RowBox[{"exists", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"forAll", "[", 
                RowBox[{"y", ",", 
                 RowBox[{"implies", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "<", "\[Delta]"}], ",", 
                   RowBox[{"y", "\[Element]", 
                    RowBox[{"intersect", "[", 
                    RowBox[{"A", ",", "B"}], "]"}]}]}], "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"ProofStep", "[", 
    RowBox[{
     RowBox[{"ProofGoal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", "27", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "A", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "28", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "B", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "[", "18", "]"}], "\[Rule]", 
         RowBox[{"forAll", "[", 
          RowBox[{"x", ",", 
           RowBox[{"implies", "[", 
            RowBox[{
             RowBox[{"x", "\[Element]", 
              RowBox[{"intersect", "[", 
               RowBox[{"A", ",", "B"}], "]"}]}], ",", 
             RowBox[{"exists", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"forAll", "[", 
                RowBox[{"y", ",", 
                 RowBox[{"implies", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "<", "\[Delta]"}], ",", 
                   RowBox[{"y", "\[Element]", 
                    RowBox[{"intersect", "[", 
                    RowBox[{"A", ",", "B"}], "]"}]}]}], "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
     ",", "\<\"Apply the `let' trick and move premise of universal-condition \
target T18 above the line.\"\>", ",", 
     RowBox[{"textString", "[", 
      RowBox[{"\<\"Let \"\>", ",", 
       RowBox[{"mathString", "[", 
        RowBox[{"\<\"x\"\>", ",", "\<\" \\\\in \"\>", ",", "\<\"A\"\>", 
         ",", "\<\" \\\\cap \"\>", ",", "\<\"B\"\>"}], "]"}], 
       ",", "\<\".\"\>"}], "]"}], ",", 
     RowBox[{"ProofGoal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", "27", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "A", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "28", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "B", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "29", "]"}], "\[Rule]", 
          RowBox[{"x", "\[Element]", 
           RowBox[{"intersect", "[", 
            RowBox[{"A", ",", "B"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "[", "19", "]"}], "\[Rule]", 
         RowBox[{"exists", "[", 
          RowBox[{"\[Delta]", ",", 
           RowBox[{"forAll", "[", 
            RowBox[{"y", ",", 
             RowBox[{"implies", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"d", "[", 
                 RowBox[{"x", ",", "y"}], "]"}], "<", "\[Delta]"}], ",", 
               RowBox[{"y", "\[Element]", 
                RowBox[{"intersect", "[", 
                 RowBox[{"A", ",", "B"}], "]"}]}]}], "]"}]}], "]"}]}], 
          "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"ProofStep", "[", 
    RowBox[{
     RowBox[{"ProofGoal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", "27", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "A", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "28", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "B", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "29", "]"}], "\[Rule]", 
          RowBox[{"x", "\[Element]", 
           RowBox[{"intersect", "[", 
            RowBox[{"A", ",", "B"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "[", "19", "]"}], "\[Rule]", 
         RowBox[{"exists", "[", 
          RowBox[{"\[Delta]", ",", 
           RowBox[{"forAll", "[", 
            RowBox[{"y", ",", 
             RowBox[{"implies", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"d", "[", 
                 RowBox[{"x", ",", "y"}], "]"}], "<", "\[Delta]"}], ",", 
               RowBox[{"y", "\[Element]", 
                RowBox[{"intersect", "[", 
                 RowBox[{"A", ",", "B"}], "]"}]}]}], "]"}]}], "]"}]}], 
          "]"}]}], "}"}]}], "]"}], 
     ",", "\<\"Quantifier-free expansion of hypothesis H29\"\>", ",", 
     RowBox[{"textString", "[", 
      RowBox[{"\<\"Since \"\>", ",", 
       RowBox[{"mathString", "[", 
        RowBox[{"\<\"x\"\>", ",", "\<\" \\\\in \"\>", ",", "\<\"A\"\>", 
         ",", "\<\" \\\\cap \"\>", ",", "\<\"B\"\>"}], "]"}], 
       ",", "\<\", \"\>", ",", 
       RowBox[{"mathString", "[", 
        RowBox[{"\<\"x\"\>", ",", "\<\" \\\\in \"\>", ",", "\<\"A\"\>"}], 
        "]"}], ",", "\<\" and \"\>", ",", 
       RowBox[{"mathString", "[", 
        RowBox[{"\<\"x\"\>", ",", "\<\" \\\\in \"\>", ",", "\<\"B\"\>"}], 
        "]"}], ",", "\<\".\"\>"}], "]"}], ",", 
     RowBox[{"ProofGoal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", "27", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "A", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "28", "]"}], "\[Rule]", 
          RowBox[{"isOpen", "[", "B", "]"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "30", "]"}], "\[Rule]", 
          RowBox[{"x", "\[Element]", "A"}]}], ",", 
         RowBox[{
          RowBox[{"H", "[", "31", "]"}], "\[Rule]", 
          RowBox[{"x", "\[Element]", "B"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "[", "19", "]"}], "\[Rule]", 
         RowBox[{"exists", "[", 
          RowBox[{"\[Delta]", ",", 
           RowBox[{"forAll", "[", 
            RowBox[{"y", ",", 
             RowBox[{"implies", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"d", "[", 
                 RowBox[{"x", ",", "y"}], "]"}], "<", "\[Delta]"}], ",", 
               RowBox[{"y", "\[Element]", 
                RowBox[{"intersect", "[", 
                 RowBox[{"A", ",", "B"}], "]"}]}]}], "]"}]}], "]"}]}], 
          "]"}]}], "}"}]}], "]"}]}], "]"}], ",", "$Failed"}], "]"}]], "Output",\

 CellChangeTimes->{{3.5958142357847843`*^9, 3.5958142950705137`*^9}, 
   3.595814580089518*^9, {3.595814661311962*^9, 3.5958146884529*^9}, {
   3.595814931218569*^9, 3.595814944321203*^9}, 3.5958150442762403`*^9, {
   3.595815371874898*^9, 3.5958153970763683`*^9}, 3.595815493643776*^9, {
   3.5958156764294653`*^9, 3.595815717236558*^9}, 3.595815757214432*^9, {
   3.5958158663791733`*^9, 3.5958158828406773`*^9}, 3.595815976848927*^9, 
   3.5958167026470757`*^9, 3.595816835717019*^9, {3.5958169204662333`*^9, 
   3.595816929574695*^9}, {3.5958169973935823`*^9, 3.59581701532655*^9}, {
   3.595817402169778*^9, 3.595817423843858*^9}, 3.595817586608014*^9, 
   3.595817734510633*^9, {3.595817860636675*^9, 3.5958178680599737`*^9}, {
   3.595893737563724*^9, 3.595893766473612*^9}, 3.595893876041884*^9, 
   3.595893964392727*^9, 3.595894001372645*^9, 3.595894081524949*^9, 
   3.595894169008849*^9, 3.595894977824335*^9, 3.595919385738044*^9, 
   3.595919524248617*^9, 3.595919622163988*^9, 3.595920166523904*^9, 
   3.595920781379916*^9, 3.595920838048052*^9, 3.595921236594821*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"andString", "[", "X_", "]"}], ":=", "X"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"andString", "[", 
   RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
  RowBox[{"textString", "[", 
   RowBox[{"X", ",", "\"\< and \>\"", ",", "Y"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"andString", "[", 
   RowBox[{"X_", ",", "Y_", ",", "Z_"}], "]"}], ":=", 
  RowBox[{"textString", "[", 
   RowBox[{
   "X", ",", "\"\<, \>\"", ",", "Y", ",", "\"\<, and \>\"", ",", "Z"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"andString", "[", 
   RowBox[{"U_", ",", "V___"}], "]"}], ":=", 
  RowBox[{"textString", "[", 
   RowBox[{"U", ",", "\"\<, \>\"", ",", 
    RowBox[{"andString", "[", "V", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.595895771202751*^9, 3.595895842958194*^9}, {
  3.5958960555833282`*^9, 3.595896059842414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goalStatement", "[", 
   RowBox[{"ProofGoal", "[", 
    RowBox[{"hypotheses_", ",", "targets_"}], "]"}], "]"}], ":=", 
  RowBox[{"tex", "[", 
   RowBox[{"\"\<If \>\"", ",", 
    RowBox[{"andString", "@@", 
     RowBox[{"(", 
      RowBox[{"tex", "/@", 
       RowBox[{"(", 
        RowBox[{"hypotheses", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ")"}]}], 
      ")"}]}], ",", "\"\< then \>\"", ",", 
    RowBox[{"andString", "@@", 
     RowBox[{"(", 
      RowBox[{"tex", "/@", 
       RowBox[{"(", 
        RowBox[{"targets", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ")"}]}], 
      ")"}]}], ",", "\"\<.\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.595895668304903*^9, 3.595895769446721*^9}, {
  3.595895909418351*^9, 3.595895921098721*^9}, {3.595895957722392*^9, 
  3.595895978052165*^9}, {3.5959194025929527`*^9, 3.5959194171982613`*^9}, {
  3.595919464502527*^9, 3.595919500369483*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"goalStatement", "[", 
   RowBox[{"proof", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "//", 
  "ToString"}]], "Input",
 CellChangeTimes->{{3.5958958488642483`*^9, 3.595895859785026*^9}, {
  3.595919628276526*^9, 3.5959196298603992`*^9}}],

Cell[BoxData["\<\"If $A$ is open and $B$ is open then $A \\\\cap B$ is \
open.\"\>"], "Output",
 CellChangeTimes->{
  3.5958958603826313`*^9, 3.5958958918847237`*^9, {3.595895922166121*^9, 
   3.595895936622882*^9}, {3.5958959691606207`*^9, 3.59589597905538*^9}, {
   3.5958960626830053`*^9, 3.595896073513011*^9}, {3.595919391050527*^9, 
   3.595919418725286*^9}, 3.5959195274370613`*^9, 3.595919592392531*^9, {
   3.595919624251135*^9, 3.595919630183514*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tex", "[", 
    RowBox[{"ProofStep", "[", 
     RowBox[{"_", ",", "_", ",", 
      RowBox[{"tex", ":", 
       RowBox[{"(", 
        RowBox[{"_textString", "|", "_mathString", "|", "_String"}], ")"}]}], 
      ",", "_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ToString", "[", "tex", "]"}], "<>", "\"\<\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tex", "[", "$Failed", "]"}], ":=", 
  "\"\<{\\\\color{red} It seems we're stuck.}\\n\>\""}]}], "Input",
 CellChangeTimes->{{3.595817659670772*^9, 3.5958176849229107`*^9}, {
  3.595817883212571*^9, 3.595817924112804*^9}, {3.5958940950004683`*^9, 
  3.595894104865048*^9}, {3.595894176016117*^9, 3.59589418515254*^9}, {
  3.59589507494026*^9, 3.5958951096020412`*^9}, {3.595896116869068*^9, 
  3.595896223348999*^9}, {3.595919636834951*^9, 3.595919637253525*^9}, {
  3.595919676592111*^9, 3.595919730276451*^9}, {3.595919765264806*^9, 
  3.5959197654406967`*^9}, {3.595919835427807*^9, 3.5959198444467297`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tex", "[", "p_PartialProof", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"\"\<\\\\begin{theorem}\\n\>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"goalStatement", "[", 
     RowBox[{"p", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "]"}], "<>", 
   "\"\<\\n\\\\end{theorem}\\n\>\"", "<>", "\[IndentingNewLine]", 
   "\"\<\\\\begin{proof}\\n\>\"", "<>", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"(", 
     RowBox[{"tex", "/@", 
      RowBox[{"(", 
       RowBox[{"List", "@@", "p"}], ")"}]}], ")"}]}], "<>", 
   "\"\<\\\\end{proof}\\n\>\""}]}]], "Input",
 CellChangeTimes->{{3.595817659670772*^9, 3.5958176849229107`*^9}, {
  3.595817883212571*^9, 3.595817924112804*^9}, {3.5958940950004683`*^9, 
  3.595894104865048*^9}, {3.595894176016117*^9, 3.59589418515254*^9}, {
  3.59589507494026*^9, 3.5958951096020412`*^9}, {3.595896116869068*^9, 
  3.595896223348999*^9}, {3.595919636834951*^9, 3.595919637253525*^9}, {
  3.595919676592111*^9, 3.595919763744935*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tex", "[", "proof", "]"}]], "Input",
 CellChangeTimes->{{3.595815884660406*^9, 3.5958158870803556`*^9}, {
  3.595817902763073*^9, 3.595817903428421*^9}, {3.5958961925281773`*^9, 
  3.5958961946778793`*^9}, {3.5959196410030737`*^9, 3.5959196420036163`*^9}}],

Cell[BoxData["\<\"\\\\begin{theorem}\\nIf $A$ is open and $B$ is open then $A \
\\\\cap B$ is open.\\n\\\\end{theorem}\\n\\\\begin{proof}\\n\\nLet $x \\\\in \
A \\\\cap B$.\\nSince $x \\\\in A \\\\cap B$, $x \\\\in A$ and $x \\\\in \
B$.\\n{\\\\color{red} It seems we're stuck.}\\n\\\\end{proof}\\n\"\>"], \
"Output",
 CellChangeTimes->{
  3.595815887671239*^9, 3.5958159790359*^9, 3.595816852930767*^9, 
   3.595817020436966*^9, {3.595817903972445*^9, 3.595817928273218*^9}, 
   3.595893770515987*^9, 3.5958941060851593`*^9, {3.595894153545576*^9, 
   3.595894186468616*^9}, {3.595895094138276*^9, 3.595895110833477*^9}, {
   3.595896189112172*^9, 3.595896224477404*^9}, 3.595919642866803*^9, 
   3.595919680256531*^9, 3.5959197396462517`*^9, {3.595919850932392*^9, 
   3.5959198594546967`*^9}, {3.595920136155766*^9, 3.5959201692112427`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdf", "[", "proof_PartialProof", "]"}], ":=", 
  RowBox[{"pdf", "[", 
   RowBox[{"tex", "[", "proof", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5958942152952223`*^9, 3.595894291213415*^9}, {
   3.595894557066032*^9, 3.595894613611204*^9}, {3.595894899676963*^9, 
   3.595894946145711*^9}, 3.59589499204254*^9, {3.5958952384162893`*^9, 
   3.59589524635975*^9}, {3.595895277690261*^9, 3.595895302361421*^9}, {
   3.595895352497686*^9, 3.595895356390266*^9}, {3.5958955567313833`*^9, 
   3.5958955572466297`*^9}, {3.595896232628253*^9, 3.595896255364913*^9}, {
   3.595901315860355*^9, 3.5959013160769167`*^9}, {3.595919867201767*^9, 
   3.595919869663329*^9}, 3.595919944750305*^9, {3.5959200797310677`*^9, 
   3.595920092041192*^9}, {3.5959211478258953`*^9, 3.595921161951118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdf", "[", "content_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetDirectory", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<scratch\>\""}], 
        "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "\"\<proof.tex\>\"", "]"}], ",", 
       RowBox[{"DeleteFile", "[", "\"\<proof.tex\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"\"\<proof.tex\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"\"\<../template.tex\>\"", ",", "\"\<String\>\""}], "]"}], 
         ",", 
         RowBox[{"\"\<%%% CONTENT %%%\>\"", "\[Rule]", "content"}]}], "]"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Run", "[", 
      "\"\<PATH=/usr/texbin/:$PATH && /usr/texbin/latexmk -pdf proof.tex  2> \
err\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Run", "[", "\"\<open proof.pdf\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ResetDirectory", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5958942152952223`*^9, 3.595894291213415*^9}, {
   3.595894557066032*^9, 3.595894613611204*^9}, {3.595894899676963*^9, 
   3.595894946145711*^9}, 3.59589499204254*^9, {3.5958952384162893`*^9, 
   3.59589524635975*^9}, {3.595895277690261*^9, 3.595895302361421*^9}, {
   3.595895352497686*^9, 3.595895356390266*^9}, {3.5958955567313833`*^9, 
   3.5958955572466297`*^9}, {3.595896232628253*^9, 3.595896255364913*^9}, {
   3.595901315860355*^9, 3.5959013160769167`*^9}, {3.595919867201767*^9, 
   3.595919869663329*^9}, 3.595919944750305*^9, {3.5959200797310677`*^9, 
   3.595920092041192*^9}, {3.595921134969294*^9, 3.595921145275208*^9}}],

Cell[BoxData[
 RowBox[{"pdf", "[", "proof", "]"}]], "Input",
 CellChangeTimes->{{3.5958945716283617`*^9, 3.595894573197207*^9}, {
  3.595896258352866*^9, 3.595896269962675*^9}, {3.595896309492008*^9, 
  3.595896309590818*^9}, {3.59589635572954*^9, 3.59589635588093*^9}, {
  3.595896542832471*^9, 3.595896542925962*^9}, {3.595919875061825*^9, 
  3.595919876345785*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"typesetProofGoalAsBox", "[", 
    RowBox[{"goal", ":", 
     RowBox[{"ProofGoal", "[", 
      RowBox[{"hypotheses_", ",", "targets_"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
   "\"\<\\\\begin{tikzpicture}\\n\>\"", "<>", "\n", 
    "\"\<\\\\node[draw,rectangle,rounded corners,inner sep=10pt] {%\\n\>\"", "<>",
     "\[IndentingNewLine]", "\"\< \\\\begin{varwidth}{15cm}\\n\>\"", "<>", 
    "\[IndentingNewLine]", 
    "\"\<  \\\\begin{itemize}[leftmargin=20pt,topsep=0pt,itemsep=0pt]%\\n\>\"\
", "<>", "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<   \\\\item[H\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "<>", 
         "\"\<] \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"tex", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "]"}], "<>", "\"\<\\n\>\""}], "&"}], "/@", "hypotheses"}], ")"}]}],
     "<>", "\[IndentingNewLine]", 
    "\"\<   \\\\vspace{-5pt}\\\\newline\\\\noindent\\\\rule{5cm}{0.3mm}\\\\\
vspace{0pt}\\n\>\"", "<>", "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<   \\\\item[T\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "<>", 
         "\"\<] \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"tex", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "]"}], "<>", "\"\<\\n\>\""}], "&"}], "/@", "targets"}], ")"}]}], "<>",
     "\[IndentingNewLine]", "\"\<  \\\\end{itemize}\\n\>\"", "<>", 
    "\[IndentingNewLine]", "\"\< \\\\end{varwidth}\\n\>\"", "<>", 
    "\[IndentingNewLine]", "\"\<};\\n\>\"", "<>", "\n", 
    "\"\<\\\\end{tikzpicture}\\n\\n\>\""}]}], "\n"}]], "Input",
 CellChangeTimes->{{3.59589948872716*^9, 3.595899538043992*^9}, {
   3.595900126191987*^9, 3.59590014402769*^9}, {3.595900211965523*^9, 
   3.5959002125355186`*^9}, {3.595900921582673*^9, 3.595901082955448*^9}, {
   3.595901144842635*^9, 3.59590114521173*^9}, {3.595901267330242*^9, 
   3.595901279982177*^9}, {3.5959203001248837`*^9, 3.595920438043174*^9}, 
   3.595921345256297*^9, {3.595922530928244*^9, 3.595922595763303*^9}, {
   3.595922637217516*^9, 3.5959226555270042`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"typesetProofGoalAsBox", "[", 
  RowBox[{"proof", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.595901019618004*^9, 3.5959010312315283`*^9}}],

Cell[BoxData["\<\"\\\\begin{tikzpicture}\\n\\\\node[draw,rectangle,rounded \
corners,inner sep=10pt] {%\\n \\\\begin{varwidth}{15cm}\\n  \
\\\\begin{itemize}[leftmargin=20pt,topsep=0pt,itemsep=0pt]%\\n   \
\\\\item[H27] $A$ is open\\n   \\\\item[H28] $B$ is open\\n   \\\\vspace{6pt}\
\\\\rule{5cm}{0.5mm}\\\\vspace{6pt}\\n   \\\\item[T17] $A \\\\cap B$ is \
open\\n  \\\\end{itemize}\\n \\\\end{varwidth}\\n};\\n\\\\end{tikzpicture}\\n\
\\n\"\>"], "Output",
 CellChangeTimes->{{3.5959010317237186`*^9, 3.5959010842117233`*^9}, {
   3.595920398215569*^9, 3.595920439405613*^9}, 3.595922544064416*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "typesetProofStep", "]"}]], "Input",
 CellChangeTimes->{{3.595921096080192*^9, 3.595921100459291*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"typesetProofStep", "[", 
   RowBox[{"step", ":", 
    RowBox[{"ProofStep", "[", 
     RowBox[{
     "goal_ProofGoal", ",", "description_String", ",", "output_", ",", 
      "result_ProofGoal"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"description", "<>", "\"\< \\\\newline\\n\>\"", "<>", 
   RowBox[{
   "typesetProofGoalAsBox", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"typesetProofStep", "[", "$Failed", "]"}], ":=", 
  "\"\<At this point, I don't know what to do next.\>\""}]}], "Input",
 CellChangeTimes->{{3.595901095541523*^9, 3.595901157610155*^9}, 
   3.595920583162787*^9, {3.5959209669850807`*^9, 3.595921008021428*^9}, {
   3.5959210396932898`*^9, 3.595921044779296*^9}, {3.595921261311973*^9, 
   3.5959212815977173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"TODO", " ", "clean", " ", "this", " ", "up"}], ",", " ", 
    RowBox[{
     RowBox[{
     "making", " ", "the", " ", "format", " ", "closer", " ", "to", " ", 
      RowBox[{"http", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"people", ".", "ds", ".", "cam", ".", "ac", ".", "uk"}], "/", 
       "mg262"}], "/", 
      RowBox[{"robotone", ".", "pdf"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"typesetProof", "[", "proof_PartialProof", "]"}], ":=", 
   RowBox[{
    RowBox[{"tex", "[", "proof", "]"}], "<>", 
    RowBox[{"typesetProofGoalAsBox", "[", 
     RowBox[{"proof", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "<>", 
    "\"\<\\\\begin{enumerate}\\n\>\"", "<>", 
    RowBox[{"(", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<\\\\item%\\n\>\"", "<>", 
          RowBox[{"typesetProofStep", "[", "#", "]"}]}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "proof"}], ")"}]}], ")"}]}], ")"}], "<>", 
    "\"\<\\\\end{enumerate}\>\""}]}]}]], "Input",
 CellChangeTimes->{{3.595901160568088*^9, 3.595901161454399*^9}, {
  3.5959012166598263`*^9, 3.595901247990025*^9}, {3.595901283115958*^9, 
  3.5959012877942543`*^9}, {3.595901424014305*^9, 3.5959014278746*^9}, {
  3.5959205399402637`*^9, 3.595920565524679*^9}, {3.595921052337577*^9, 
  3.595921059286848*^9}, {3.595922373159562*^9, 3.595922409709667*^9}, {
  3.595923849345394*^9, 3.595923866148119*^9}}],

Cell[BoxData[
 RowBox[{"pdf", "[", 
  RowBox[{"typesetProof", "[", "proof", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.595920568797442*^9, 3.595920571760538*^9}, {
  3.5959211699757442`*^9, 3.5959211708231688`*^9}}]
},
WindowSize->{1167, 682},
WindowMargins->{{Automatic, 57}, {25, Automatic}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 456, 14, 28, "Input"],
Cell[1016, 36, 946, 23, 46, "Input"],
Cell[1965, 61, 445, 10, 28, "Input"],
Cell[2413, 73, 447, 10, 28, "Input"],
Cell[2863, 85, 447, 10, 63, "Input"],
Cell[3313, 97, 384, 9, 63, "Input"],
Cell[3700, 108, 233, 4, 28, "Input"],
Cell[3936, 114, 1416, 31, 80, "Input"],
Cell[5355, 147, 1844, 43, 80, "Input"],
Cell[7202, 192, 1859, 44, 80, "Input"],
Cell[9064, 238, 225, 5, 28, "Input"],
Cell[9292, 245, 1168, 28, 63, "Input"],
Cell[10463, 275, 3731, 92, 233, "Input"],
Cell[14197, 369, 324, 6, 46, "Input"],
Cell[14524, 377, 740, 20, 46, "Input"],
Cell[CellGroupData[{
Cell[15289, 401, 1186, 27, 28, "Input"],
Cell[16478, 430, 9115, 222, 233, "Output"]
}, Open  ]],
Cell[25608, 655, 884, 23, 80, "Input"],
Cell[26495, 680, 1022, 24, 46, "Input"],
Cell[CellGroupData[{
Cell[27542, 708, 316, 7, 28, "Input"],
Cell[27861, 717, 461, 7, 28, "Output"]
}, Open  ]],
Cell[28337, 727, 1035, 22, 47, "Input"],
Cell[29375, 751, 1055, 21, 63, "Input"],
Cell[CellGroupData[{
Cell[30455, 776, 280, 4, 28, "Input"],
Cell[30738, 782, 844, 12, 182, "Output"]
}, Open  ]],
Cell[31597, 797, 822, 13, 28, "Input"],
Cell[32422, 812, 2024, 43, 148, "Input"],
Cell[34449, 857, 368, 6, 28, "Input"],
Cell[34820, 865, 2631, 56, 233, "Input"],
Cell[CellGroupData[{
Cell[37476, 925, 237, 4, 28, "Input"],
Cell[37716, 931, 600, 8, 250, "Output"]
}, Open  ]],
Cell[38331, 942, 139, 2, 28, "Input"],
Cell[38473, 946, 816, 17, 63, "Input"],
Cell[39292, 965, 1607, 38, 63, "Input"],
Cell[40902, 1005, 218, 4, 28, "Input"]
}
]
*)

(* End of internal cache information *)
